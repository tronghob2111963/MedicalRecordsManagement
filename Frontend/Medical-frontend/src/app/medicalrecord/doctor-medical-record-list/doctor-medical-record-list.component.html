<div class="medical-record-container">
    <!-- Header -->
    <div class="header">
        <h2>Danh s√°ch h·ªì s∆° b·ªánh √°n</h2>
        <div class="doctor-info" *ngIf="doctor_Name">
            <span class="doctor-label">B√°c sƒ©:</span>
            <span class="doctor-name">{{ doctor_Name }}</span>
        </div>
    </div>

    <!-- Controls -->
    <div class="controls">
        <div class="control-group">
            <label for="pageSize">Hi·ªÉn th·ªã:</label>
            <select id="pageSize" [(ngModel)]="pageSize" (change)="onPageSizeChange()" class="form-select">
                <option *ngFor="let size of pageSizeOptions" [value]="size">{{ size }} b·∫£n ghi</option>
            </select>
        </div>

        <div class="control-group">
            <label for="sortBy">S·∫Øp x·∫øp theo:</label>
            <select id="sortBy" [(ngModel)]="sortBy" (change)="onSortChange()" class="form-select">
                <option *ngFor="let option of sortOptions" [value]="option.value">{{ option.label }}</option>
            </select>
        </div>

        <button type="button" class="btn-refresh" (click)="refreshData()" [disabled]="isLoading">
            <span *ngIf="!isLoading">üîÑ</span>
            <span *ngIf="isLoading">‚è≥</span>
            L√†m m·ªõi
        </button>

    </div>

    <!-- Loading state -->
    <div *ngIf="isLoading" class="loading">
        <div class="loading-spinner"></div>
        <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
    </div>

    <!-- Error message -->
    <div *ngIf="errorMessage && !isLoading" class="error-message">
        <p>{{ errorMessage }}</p>
        <button type="button" class="btn-retry" (click)="refreshData()">Th·ª≠ l·∫°i</button>
    </div>

    <!-- Data table -->
    <div *ngIf="!isLoading && !errorMessage" class="table-container">
        <!-- Summary info -->
        <div class="summary-info">
            <p>T·ªïng s·ªë: <strong>{{ totalElements }}</strong> b·∫£n ghi |
                Trang <strong>{{ currentPage }}</strong> / <strong>{{ totalPages }}</strong></p>
        </div>

        <!-- Table -->
        <div class="table-wrapper">
            <table class="medical-records-table" *ngIf="medicalRecords.length > 0">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>T√™n b·ªánh nh√¢n</th>
                        <th>T√™n b√°c sƒ©</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>Ghi ch√∫</th>
                        <th>Thao t√°c</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let record of medicalRecords; trackBy: trackByRecordId">
                        <td class="record-id">{{ record.id }}</td>
                        <td class="patient-name">{{ record.patient_Name }}</td>
                        <td class="doctor-name">{{ record.doctor_Name }}</td>
                        <td class="status-cell">
                            <span class="status-badge" [ngClass]="getStatusClass(record.status)">
                                {{ getStatusDisplay(record.status) }}
                            </span>
                        </td>
                        <td class="note-cell">
                            <div class="note-content" [title]="record.note">
                                {{ record.note | slice:0:50 }}
                                <span *ngIf="record.note && record.note.length > 50">...</span>
                            </div>
                        </td>
                        <td class="actions-cell">
                            <button type="button" class="btn-view" title="Xem chi ti·∫øt" (click)="viewMedicalDetail(record.id)">
                                üëÅÔ∏è Xem
                            </button>
                            <button type="button" class="btn-edit" title="Ch·ªânh s·ª≠a" (click)="editMedicalRecord(record.id)">
                                ‚úèÔ∏è S·ª≠a
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>

            <!-- Empty state -->
            <div *ngIf="medicalRecords.length === 0" class="empty-state">
                <div class="empty-icon">üìã</div>
                <h3>Kh√¥ng c√≥ h·ªì s∆° b·ªánh √°n n√†o</h3>
                <p>B√°c sƒ© n√†y ch∆∞a c√≥ h·ªì s∆° b·ªánh √°n n√†o ƒë∆∞·ª£c ghi nh·∫≠n.</p>
            </div>
        </div>

        <!-- Pagination -->
        <div class="pagination" *ngIf="totalPages > 1">
            <button type="button" class="btn-page" [disabled]="!hasPreviousPage()"
                (click)="onPageChange(currentPage - 1)">
                ‚Äπ Tr∆∞·ªõc
            </button>

            <button type="button" *ngFor="let page of getPageNumbers()" class="btn-page"
                [class.active]="page === currentPage" (click)="onPageChange(page)">
                {{ page }}
            </button>

            <button type="button" class="btn-page" [disabled]="!hasNextPage()" (click)="onPageChange(currentPage + 1)">
                Sau ‚Ä∫
            </button>
        </div>
    </div>
    </div>